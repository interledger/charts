replicaCount: 1

nodeSelector: {}

serviceAccount:
  create: false
  annotations: {}
  name: ""

autoscaling:
  enabled: false
  minReplicas: 2
  maxReplicas: 1
  cpuUtilizationPercentage: 80
  memoryUtilizationPercentage: 80

# When using native GCE ingress, the service will not initialise because rafiki-auth does not provide a 200
# on the root path. In these cases you can define a health check to be used by the ingress.
#
# Can be used to create health checks when using GCP. Your service can then be annotated with 
# the created health check.
#
# For example:
# annotations:
#   cloud.google.com/neg: '{"ingress": true}'
#   cloud.google.com/backend-config: '{"default": "rafiki-auth-healthzcheck"}
#
# backendConfigs:
#   - name: healthzcheck
#     spec:
#       healthCheck:
#         checkIntervalSec: 5
#         timeoutSec: 5
#         healthyThreshold: 2
#         unhealthyThreshold: 2
#         type: HTTP
#         requestPath: /healthz
#         port: 3006

service:
  - name: service
    type: ClusterIP
    ports:
      - port: 3000
        targetPort: 3000
        protocol: TCP
        name: open-payments
      - port: 3001
        targetPort: 3001
        protocol: TCP
        name: admin
      - port: 3002
        targetPort: 3002
        protocol: TCP
        name: connector

configmap:
  - files/config.yaml

secrets:
  - files/secret.yaml

containers:
  - name: server
    envFrom:
      - configMapRef:
          name: "{{ .Release.Name }}"
      - secretRef:
          name: "{{ .Release.Name }}"
    resources:
      requests:
        memory: 256Mi
        cpu: 1
      limits:
        memory: 2048Mi
        cpu: 4
    ports:
      - name: open-payments
        containerPort: 3000
        protocol: TCP
      - name: admin
        containerPort: 3001
        protocol: TCP
      - name: connector
        containerPort: 3002
        protocol: TCP

nodeEnv: development
logLevel: debug

instanceName: rafiki-backend-changeme

serviceUrls:
  PUBLIC_HOST: http://rafiki-backend
  OPEN_PAYMENTS_URL: http://rafiki-backend
  PAYMENT_POINTER_URL: http://rafiki-backend/.well-known/pay

auth:
  grantUrl: http://rafiki-auth.rafiki-auth:3006
  introspectionUrl: http://rafiki-auth.rafiki-auth:3007

rates:
  url: http://rafiki-backend/prices

quote:
  url: http://rafiki-backend/quotes

webhook:
  url: http://rafiki-backend/webhooks
  timeout: 200

redis:
  auth:
    enabled: false
  host: 'rafiki-backend-redis-master'
  port: "6379"
  tlsCaFile: ''
  tlsCertFile: ''
  tlsKeyFile: ''
  architecture: standalone

postgresql:
  replication:
    enabled: false
  metrics:
    enabled: false
  primary:
    initdb:
      scripts:
        initialize_backend.sql: |
          CREATE USER rafiki-backend WITH PASSWORD 'rafiki-backend';
          CREATE DATABASE rafiki-backend OWNER rafiki-backend;
    persistence:
      enabled: true
  host: "rafiki-backend-postgresql"
  port: "5432"
  auth:
    username: "rafiki-backend"
    database: "rafiki-backend"
    password: "rafiki-backend"

walletAddressRedirectHtmlPage: ''

trustProxy: true
port:
  admin: 3001
  connector: 3002
  openPayments: 3000
ilp:
  address: test.rafiki-backend  # override this value
  connectorUrl: 'http://rafiki-backend:3002'
  streamSecret: "BjPXtnd00G2mRQwP/8ZpwyZASOch5sUXT5o0iR5b5wU="  # override this value
  slippage: 0.01
key:
  id: rafiki
  file: ''
quoteSignatureSecret: "overridethisValue"
withdrawalThrottleDelay: ''
lifetime:
  exchangeRate: 15000
  quote: 300000
  webhook: 200
workers:
  incomingPayment: 1
  outgoingPayment: 4
  paymentPointer: 1
  webhook: 1
workerIdle: 200
idempotency:
  keyTTL: 86400000
  keyLock: 2000

telemetry:
  enabled: false
