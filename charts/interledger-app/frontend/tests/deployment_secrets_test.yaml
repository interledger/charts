suite: Interledger App Frontend - Default deployment secret references
templates:
  - deployment.server.yaml
set:
  fullnameOverride: wallet-frontend
release:
  name: wallet-frontend
tests:
  - it: 'Secret reference for COOKIE_SECRETS should point to the correct key in secret'
    documentSelector:
      path: kind
      value: Deployment
    asserts:
      - equal:
          path: spec.template.spec.containers[0].env[0].name
          value: COOKIE_SECRETS
      - equal:
          path: spec.template.spec.containers[0].env[0].valueFrom.secretKeyRef.name
          value: wallet-frontend
      - equal:
          path: spec.template.spec.containers[0].env[0].valueFrom.secretKeyRef.key
          value: cookieSecretsArrStr
  - it: 'Should have DATO_API_TOKEN environment variable with correct secret reference'
    documentSelector:
      path: kind
      value: Deployment
    asserts:
      - contains:
          path: spec.template.spec.containers[0].env
          content:
            name: DATO_API_TOKEN
            valueFrom:
              secretKeyRef:
                name: wallet-frontend
                key: datoApiToken
