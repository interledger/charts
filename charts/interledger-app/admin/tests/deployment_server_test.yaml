suite: Wallet Admin - Default values file
templates:
  - configMap.yaml
  - deployment.server.yaml
set:
  fullnameOverride: wallet-admin
release:
  name: wallet-admin
tests:
  - it: 'Should create a deployment called wallet-admin'
    template: deployment.server.yaml
    documentSelector:
      path: kind
      value: Deployment
    asserts:
      - equal:
          path: metadata.name
          value: wallet-admin-server
  - it: 'Should provide readinessProbe and livenessProbe in the deployment'
    template: deployment.server.yaml  
    asserts:
      - equal:
          path: spec.template.spec.containers[0].readinessProbe.httpGet.path
          value: /healthz
      - equal:
          path: spec.template.spec.containers[0].livenessProbe.httpGet.path
          value: /healthz
  - it: 'Should provide topologySpreadConstraints in the deployment'
    template: deployment.server.yaml  
    asserts:
      - equal:
          path: spec.template.spec.topologySpreadConstraints[0].topologyKey
          value: kubernetes.io/hostname
      - equal:
          path: spec.template.spec.topologySpreadConstraints[0].whenUnsatisfiable
          value: DoNotSchedule
  - it: 'Should pull in configMap using envFrom'
    template: deployment.server.yaml  
    asserts:
      - equal:
          path: spec.template.spec.containers[0].envFrom[0].configMapRef.name
          value: wallet-admin-config

