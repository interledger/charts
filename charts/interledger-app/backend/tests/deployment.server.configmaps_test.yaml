suite: Interledger App - Check configmap
templates:
  - configMap.yaml
set:
  fullnameOverride: wallet-backend
release:
  name: wallet-backend
tests:
  - it: 'should contain a empty BLOCKED_REGIONS in data'
    set:
      config:
        region_blocking:
          blocked_regions: ""
          allowed_wallet_ids: ""
    asserts:
      - equal:
          path: data.BLOCKED_REGIONS
          value: ""
  - it: 'should contain a non-empty BLOCKED_REGIONS in data'
    set:
      config:
        region_blocking:
          blocked_regions: "ZA,US,CA"
          allowed_wallet_ids: "wallet1,wallet2"    
    asserts:
      - equal:
          path: data.BLOCKED_REGIONS
          value: "ZA,US,CA"
      - equal:
          path: data.ALLOWED_WALLET_IDS
          value: "wallet1,wallet2"
  - it: 'should contain GATEHUB_API_BASE_URL in data'
    set:
      config:
        gatehub:
          api_base_url: "http://mockgatehub:8080"
    asserts:
      - equal:
          path: data.GATEHUB_API_BASE_URL
          value: "http://mockgatehub:8080"
  - it: 'should contain GATEHUB_ONBOARDING_BASE_URL in data'
    set:
      config:
        gatehub:
          onboarding_base_url: "https://onboarding.sandbox.gatehub.net"
    asserts:
      - equal:
          path: data.GATEHUB_ONBOARDING_BASE_URL
          value: "https://onboarding.sandbox.gatehub.net"
  - it: 'should contain GATEHUB_ON_OFF_RAMP_BASE_URL in data'
    set:
      config:
        gatehub:
          on_off_ramp_base_url: "https://managed-ramp.sandbox.gatehub.net"
    asserts:
      - equal:
          path: data.GATEHUB_ON_OFF_RAMP_BASE_URL
          value: "https://managed-ramp.sandbox.gatehub.net"
  - it: 'should contain GATEHUB_ON_OFF_RAMP_CLIENT_ID in data'
    set:
      config:
        gatehub:
          on_off_ramp_client_id: "f8119dfd-e563-44ee-9ae2-1e60a4fce74f"
    asserts:
      - equal:
          path: data.GATEHUB_ON_OFF_RAMP_CLIENT_ID
          value: "f8119dfd-e563-44ee-9ae2-1e60a4fce74f"
  - it: 'should contain GATEHUB_ONBOARDING_CLIENT_ID in data'
    set:
      config:
        gatehub:
          onboarding_client_id: "4df24d1b-5796-4eec-951b-21699d61b970"
    asserts:
      - equal:
          path: data.GATEHUB_ONBOARDING_CLIENT_ID
          value: "4df24d1b-5796-4eec-951b-21699d61b970"
  - it: 'should contain GATEHUB_EXCHANGE_CLIENT_ID in data'
    set:
      config:
        gatehub:
          exchange_client_id: "4e28d4df-22d7-414c-97a3-d71956df29ba"
    asserts:
      - equal:
          path: data.GATEHUB_EXCHANGE_CLIENT_ID
          value: "4e28d4df-22d7-414c-97a3-d71956df29ba"
  - it: 'should contain GATEHUB_CARD_ACCOUNT_PRODUCT_CODE in data'
    set:
      config:
        gatehub:
          card_account_product_code: "PWSR_DEBP_2404"
    asserts:
      - equal:
          path: data.GATEHUB_CARD_ACCOUNT_PRODUCT_CODE
          value: "PWSR_DEBP_2404"
  - it: 'should contain PTI_BASE_URL in data'
    set:
      config:
        pti:
          base_url: "https://pti-base-url.com"
    asserts:
      - equal:
          path: data.PTI_BASE_URL
          value: "https://pti-base-url.com"
  - it: 'should contain PORT in data'
    set:
      config:
        port: "8080"
    asserts:
      - equal:
          path: data.PORT
          value: "8080"
